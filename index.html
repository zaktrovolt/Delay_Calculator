<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Delay Calculator</title>
  <style>
    body {
      font-family: 'Tahoma', sans-serif;
      background-color: #C0C0C0;
      color: #000;
      margin: 0;
      padding: 20px;
    }

    .window {
      background-color: #DFDFDF;
      border: 2px solid #000;
      width: 500px;
      margin: 0 auto;
      padding: 16px;
      box-shadow: inset -2px -2px 0 #fff, inset 2px 2px 0 #808080;
    }

    .title-bar {
      background: #000080;
      color: #fff;
      padding: 4px 8px;
      font-weight: bold;
      text-align: left;
    }

    .input-label {
      margin-top: 12px;
      font-weight: bold;
    }

    input[type="number"] {
      width: 97.3%;
      padding: 5px;
      margin-top: 4px;
	  margin-right: 0px;
      border: 2px solid #808080;
      box-shadow: inset -1px -1px 0 #fff, inset 1px 1px 0 #404040;
      background-color: #fff;
      font-family: 'Tahoma', sans-serif;
    }

    .section {
      margin-top: 20px;
      border: 2px solid #000;
      padding: 10px;
      box-shadow: inset -2px -2px 0 #fff, inset 2px 2px 0 #808080;
    }

    .section-title {
      font-weight: bold;
      margin-bottom: 8px;
      border-bottom: 1px solid #000;
    }

    .list-item {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      padding: 2px 0;
    }

    .delay-value {
      background: #C0C0C0;
      padding: 2px 4px;
      border: 2px outset #fff;
      font-family: monospace;
    }

    footer {
      margin-top: 20px;
      text-align: center;
      font-size: 11px;
      color: #333;
    }
  </style>
</head>
<body>

  <div class="window">
    <div class="title-bar">Tempo-Synced Delay Calculator</div>

    <label for="bpm" class="input-label">Enter BPM:</label>
    <input type="number" id="bpm" min="0" max="500" />
	<label class="input-label" style="display: flex; align-items: center; gap: 8px; margin-top: 16px;">
	<input type="checkbox" id="roundToggle" checked />
	Round to whole numbers
	</label>

    <div id="results-container" class="section" style="margin-top: 16px;">
      <!-- Delay results go here -->
    </div>

    <footer>
      &copy; <span id="currentYear"></span> /dmp/ Delay Calculator. All delays shown in milliseconds (ms).
    </footer>
  </div>

  <script>
  const bpmInput = document.getElementById('bpm');
  const resultsContainer = document.getElementById('results-container');
  const roundToggle = document.getElementById('roundToggle');
  const currentYearSpan = document.getElementById('currentYear');

  const noteDefinitions = [
    { name: "Whole Note (1/1)", type: "standard", factor: 4 },
    { name: "Half Note (1/2)", type: "standard", factor: 2 },
    { name: "Quarter Note (1/4)", type: "standard", factor: 1 },
    { name: "8th Note (1/8)", type: "standard", factor: 0.5 },
    { name: "16th Note (1/16)", type: "standard", factor: 0.25 },
    { name: "32nd Note (1/32)", type: "standard", factor: 0.125 },
    { name: "64th Note (1/64)", type: "standard", factor: 0.0625 },
    { name: "Dotted Half Note", type: "dotted", factor: 2 * 1.5 },
    { name: "Dotted Quarter Note", type: "dotted", factor: 1 * 1.5 },
    { name: "Dotted 8th Note", type: "dotted", factor: 0.5 * 1.5 },
    { name: "Dotted 16th Note", type: "dotted", factor: 0.25 * 1.5 },
    { name: "Dotted 32nd Note", type: "dotted", factor: 0.125 * 1.5 },
    { name: "Half Note Triplet (in 1 Whole Note)", type: "triplet", baseNoteFactor: 4, divisor: 3 },
    { name: "Quarter Note Triplet (in 1 Half Note)", type: "triplet", baseNoteFactor: 2, divisor: 3 },
    { name: "8th Note Triplet (in 1 Quarter Note)", type: "triplet", baseNoteFactor: 1, divisor: 3 },
    { name: "16th Note Triplet (in 1 8th Note)", type: "triplet", baseNoteFactor: 0.5, divisor: 3 },
    { name: "32nd Note Triplet (in 1 16th Note)", type: "triplet", baseNoteFactor: 0.25, divisor: 3 },
  ];

  function calculateAndDisplayDelays() {
    const bpm = parseFloat(bpmInput.value);
    const roundValues = roundToggle.checked;

    if (isNaN(bpm) || bpm <= 0) {
      resultsContainer.innerHTML = '<p>Enter a valid BPM to see delay times.</p>';
      return;
    }

    const quarterNoteDelay = 60000 / bpm;
    const groupedNotes = { standard: [], dotted: [], triplet: [] };

    noteDefinitions.forEach(note => {
      let delayMs;
      if (note.type === "triplet") {
        delayMs = (quarterNoteDelay * note.baseNoteFactor) / note.divisor;
      } else {
        delayMs = quarterNoteDelay * note.factor;
      }

      const displayValue = roundValues ? Math.round(delayMs) : delayMs.toFixed(2);
      groupedNotes[note.type].push({ name: note.name, value: displayValue });
    });

    const createSection = (title, notes) => {
      if (notes.length === 0) return '';
      let html = `<div class="section-title">${title}</div>`;
      notes.forEach(note => {
        html += `
          <div class="list-item">
            <span>${note.name}</span>
            <span class="delay-value">${note.value} ms</span>
          </div>`;
      });
      return html;
    };

    resultsContainer.innerHTML =
      createSection("Standard Note Delays", groupedNotes.standard) +
      createSection("Dotted Note Delays", groupedNotes.dotted) +
      createSection("Triplet Note Delays", groupedNotes.triplet);
  }

  bpmInput.addEventListener('input', calculateAndDisplayDelays);
  bpmInput.addEventListener('change', calculateAndDisplayDelays);
  roundToggle.addEventListener('change', calculateAndDisplayDelays);

  document.addEventListener('DOMContentLoaded', () => {
    currentYearSpan.textContent = new Date().getFullYear();
    calculateAndDisplayDelays();
  });
</script>


</body>
</html>
